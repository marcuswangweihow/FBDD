---
title: "representative_snapshots"
nav_order: 1
---

# representative_snapshots

<!-- REPO_TOC -->
# FBDD Repository Structure
- [FBDD](../../../../)
  - [Frag_to_lead](../../../)
    - [Frag_to_lead_4MZI](../../)
      - [100ps_Preliminary Results](../../100ps_Preliminary%20Results/)
        - [100ps_pipeline_test](../../100ps_Preliminary%20Results/100ps_pipeline_test/)
          - [NPT_equil](../../100ps_Preliminary%20Results/100ps_pipeline_test/NPT_equil/)
          - [NVT_equil](../../100ps_Preliminary%20Results/100ps_pipeline_test/NVT_equil/)
          - [Production](../../100ps_Preliminary%20Results/100ps_pipeline_test/Production/)
          - [em](../../100ps_Preliminary%20Results/100ps_pipeline_test/em/)
        - [binding_event_detection](../../100ps_Preliminary%20Results/binding_event_detection/)
        - [mdpocket_figures](../../100ps_Preliminary%20Results/mdpocket_figures/)
        - [plumed_metad_cvs](../../100ps_Preliminary%20Results/plumed_metad_cvs/)
        - [representative_snapshots](../../100ps_Preliminary%20Results/representative_snapshots/)
      - [100ps_run_for_checkpoint_testing](../../100ps_run_for_checkpoint_testing/)
      - [1ns_Preliminary Results](../../1ns_Preliminary%20Results/)
        - [1ns_pipeline_test](../../1ns_Preliminary%20Results/1ns_pipeline_test/)
          - [NPT_equil](../../1ns_Preliminary%20Results/1ns_pipeline_test/NPT_equil/)
          - [NVT_equil](../../1ns_Preliminary%20Results/1ns_pipeline_test/NVT_equil/)
          - [Production](../../1ns_Preliminary%20Results/1ns_pipeline_test/Production/)
          - [em](../../1ns_Preliminary%20Results/1ns_pipeline_test/em/)
        - [binding_event_detection](../../1ns_Preliminary%20Results/binding_event_detection/)
        - [mdpocket_figures](../../1ns_Preliminary%20Results/mdpocket_figures/)
        - [occupancy_maps](../../1ns_Preliminary%20Results/occupancy_maps/)
        - [plumed_metad_cvs](../../1ns_Preliminary%20Results/plumed_metad_cvs/)
        - [representative_snapshots](../../1ns_Preliminary%20Results/representative_snapshots/)
      - [1ns_withpullres_withcheckpoints_Preliminary Results](../)
        - [1ns_pipeline_test](../1ns_pipeline_test/)
          - [NPT_equil](../1ns_pipeline_test/NPT_equil/)
          - [NVT_equil](../1ns_pipeline_test/NVT_equil/)
          - [Production](../1ns_pipeline_test/Production/)
          - [em](../1ns_pipeline_test/em/)
        - [binding_event_detection](../binding_event_detection/)
        - [mdpocket_figures](../mdpocket_figures/)
        - [occupancy_maps](../occupancy_maps/)
        - [plumed_metad_cvs](../plumed_metad_cvs/)
        - [representative_snapshots](./)
  - [docking_4MZI_roscovitine](../../../../docking_4MZI_roscovitine/)
  - [docs](../../../../docs/)
    - [Frag_to_lead](../../../../docs/Frag_to_lead/)
      - [Frag_to_lead_4MZI](../../../../docs/Frag_to_lead/Frag_to_lead_4MZI/)
        - [100ps_Preliminary_Results](../../../../docs/Frag_to_lead/Frag_to_lead_4MZI/100ps_Preliminary_Results/)
          - [100ps_pipeline_test](../../../../docs/Frag_to_lead/Frag_to_lead_4MZI/100ps_Preliminary_Results/100ps_pipeline_test/)
            - [NPT_equil](../../../../docs/Frag_to_lead/Frag_to_lead_4MZI/100ps_Preliminary_Results/100ps_pipeline_test/NPT_equil/)
            - [NVT_equil](../../../../docs/Frag_to_lead/Frag_to_lead_4MZI/100ps_Preliminary_Results/100ps_pipeline_test/NVT_equil/)
            - [Production](../../../../docs/Frag_to_lead/Frag_to_lead_4MZI/100ps_Preliminary_Results/100ps_pipeline_test/Production/)
            - [em](../../../../docs/Frag_to_lead/Frag_to_lead_4MZI/100ps_Preliminary_Results/100ps_pipeline_test/em/)
          - [binding_event_detection](../../../../docs/Frag_to_lead/Frag_to_lead_4MZI/100ps_Preliminary_Results/binding_event_detection/)
          - [mdpocket_figures](../../../../docs/Frag_to_lead/Frag_to_lead_4MZI/100ps_Preliminary_Results/mdpocket_figures/)
          - [plumed_metad_cvs](../../../../docs/Frag_to_lead/Frag_to_lead_4MZI/100ps_Preliminary_Results/plumed_metad_cvs/)
          - [representative_snapshots](../../../../docs/Frag_to_lead/Frag_to_lead_4MZI/100ps_Preliminary_Results/representative_snapshots/)
        - [100ps_run_for_checkpoint_testing](../../../../docs/Frag_to_lead/Frag_to_lead_4MZI/100ps_run_for_checkpoint_testing/)
        - [1ns_Preliminary_Results](../../../../docs/Frag_to_lead/Frag_to_lead_4MZI/1ns_Preliminary_Results/)
          - [1ns_pipeline_test](../../../../docs/Frag_to_lead/Frag_to_lead_4MZI/1ns_Preliminary_Results/1ns_pipeline_test/)
            - [NPT_equil](../../../../docs/Frag_to_lead/Frag_to_lead_4MZI/1ns_Preliminary_Results/1ns_pipeline_test/NPT_equil/)
            - [NVT_equil](../../../../docs/Frag_to_lead/Frag_to_lead_4MZI/1ns_Preliminary_Results/1ns_pipeline_test/NVT_equil/)
            - [Production](../../../../docs/Frag_to_lead/Frag_to_lead_4MZI/1ns_Preliminary_Results/1ns_pipeline_test/Production/)
            - [em](../../../../docs/Frag_to_lead/Frag_to_lead_4MZI/1ns_Preliminary_Results/1ns_pipeline_test/em/)
          - [binding_event_detection](../../../../docs/Frag_to_lead/Frag_to_lead_4MZI/1ns_Preliminary_Results/binding_event_detection/)
          - [mdpocket_figures](../../../../docs/Frag_to_lead/Frag_to_lead_4MZI/1ns_Preliminary_Results/mdpocket_figures/)
          - [occupancy_maps](../../../../docs/Frag_to_lead/Frag_to_lead_4MZI/1ns_Preliminary_Results/occupancy_maps/)
          - [plumed_metad_cvs](../../../../docs/Frag_to_lead/Frag_to_lead_4MZI/1ns_Preliminary_Results/plumed_metad_cvs/)
          - [representative_snapshots](../../../../docs/Frag_to_lead/Frag_to_lead_4MZI/1ns_Preliminary_Results/representative_snapshots/)
        - [1ns_withpullres_withcheckpoints_Preliminary_Results](../../../../docs/Frag_to_lead/Frag_to_lead_4MZI/1ns_withpullres_withcheckpoints_Preliminary_Results/)
          - [1ns_pipeline_test](../../../../docs/Frag_to_lead/Frag_to_lead_4MZI/1ns_withpullres_withcheckpoints_Preliminary_Results/1ns_pipeline_test/)
            - [NPT_equil](../../../../docs/Frag_to_lead/Frag_to_lead_4MZI/1ns_withpullres_withcheckpoints_Preliminary_Results/1ns_pipeline_test/NPT_equil/)
            - [NVT_equil](../../../../docs/Frag_to_lead/Frag_to_lead_4MZI/1ns_withpullres_withcheckpoints_Preliminary_Results/1ns_pipeline_test/NVT_equil/)
            - [Production](../../../../docs/Frag_to_lead/Frag_to_lead_4MZI/1ns_withpullres_withcheckpoints_Preliminary_Results/1ns_pipeline_test/Production/)
            - [em](../../../../docs/Frag_to_lead/Frag_to_lead_4MZI/1ns_withpullres_withcheckpoints_Preliminary_Results/1ns_pipeline_test/em/)
          - [binding_event_detection](../../../../docs/Frag_to_lead/Frag_to_lead_4MZI/1ns_withpullres_withcheckpoints_Preliminary_Results/binding_event_detection/)
          - [mdpocket_figures](../../../../docs/Frag_to_lead/Frag_to_lead_4MZI/1ns_withpullres_withcheckpoints_Preliminary_Results/mdpocket_figures/)
          - [occupancy_maps](../../../../docs/Frag_to_lead/Frag_to_lead_4MZI/1ns_withpullres_withcheckpoints_Preliminary_Results/occupancy_maps/)
          - [plumed_metad_cvs](../../../../docs/Frag_to_lead/Frag_to_lead_4MZI/1ns_withpullres_withcheckpoints_Preliminary_Results/plumed_metad_cvs/)
          - [representative_snapshots](../../../../docs/Frag_to_lead/Frag_to_lead_4MZI/1ns_withpullres_withcheckpoints_Preliminary_Results/representative_snapshots/)
    - [docking_4MZI_roscovitine](../../../../docs/docking_4MZI_roscovitine/)
    - [images](../../../../docs/images/)
  - [images](../../../../images/)
<!-- /REPO_TOC -->






-----------------------------------------------------------

The results here are **preliminary** results for a 1ns production run of the pipeline for worklflow functionality illustration purposes. 

Representative snapshots: Protein-only PDBs selected from a full trajectory (1ns) using RMSD clustering, KDE peaks, and DBSCAN clustering on probe center-of-mass positions.
These snapshots are used as input for downstream docking and MDpocket pocket analysis.

# Representative Snapshot Selection

Full trajectory frames were analyzed to select representative protein conformations.

Selection criteria:

 - RMSD clustering to identify conformational regimes.

 - KDE peak detection on probe positions.

 - DBSCAN clustering to find dense probe-sampling regions.

Selected snapshots are protein-only PDBs, stripped of hydrogens.

# Docking Preparation and Execution

docking_prep.py and prepare_protein_snapshots.py are provided in this folder. 

These scripts are intended to work on Windows.

For Linux and Mac users:
Use `conda install -c conda-forge autodock-vina` and adapt docking_prep.py and prepare_protein_snapshots.py to make them work.

## 1. Inspect the Docking Prep Folder

After running the integrated docking prep script (docking_prep.py), navigate to the docking folder:

C:\Users\Admin\Documents\Documents\Misc\FBDD project\docking_prep

You should see the following files:

- `*_cleaned.pdbqt` → prepared receptor files for each representative snapshot.  
- `*_grid_*.txt` → AutoDock Vina config files (one per KDE peak per snapshot).  
- `run_all_vina.bat` → batch file containing all Vina docking commands.  
- Ligands in `pdbqt_fragment_library` → prepared ligand files (.pdbqt) ready for docking.

---

## 2. Run the Batch Docking

On Windows:

1. Open a **Command Prompt (CMD)** or **PowerShell**.  
2. Navigate to the docking folder:

```cmd
cd "C:\Users\Admin\Documents\Documents\Misc\FBDD project\docking_prep"
```

3. Execute the batch file:
```cmd
run_all_vina.bat
```







